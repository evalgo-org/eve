{
  "server": {
    "host": "0.0.0.0",
    "port": 8880,
    "read_timeout": "30s",
    "write_timeout": "30s",
    "idle_timeout": "60s"
  },
  "auth": {
    "type": "api-key",
    "header": "X-API-Key",
    "keys": [
      "your-api-key-here"
    ],
    "bypass": [
      "/health"
    ]
  },
  "cors": {
    "enabled": true,
    "allowed_origins": ["*"],
    "allowed_methods": ["GET", "POST", "PUT", "DELETE", "OPTIONS"],
    "allowed_headers": ["Content-Type", "Authorization", "X-API-Key"],
    "exposed_headers": ["Content-Length"],
    "allow_credentials": false,
    "max_age": 3600
  },
  "logging": {
    "enabled": true,
    "level": "info",
    "format": "json",
    "include_body": false,
    "exclude_paths": ["/health"]
  },
  "defaults": {
    "timeout": "30s",
    "max_retries": 3,
    "load_balancing": "round-robin",
    "health_check": {
      "enabled": true,
      "interval": "30s",
      "timeout": "5s",
      "path": "/health",
      "expected_status": 200,
      "failure_count": 3,
      "success_count": 2
    },
    "retry": {
      "max_attempts": 3,
      "initial_interval": "1s",
      "max_interval": "10s",
      "multiplier": 2.0,
      "retryable_status": [502, 503, 504]
    },
    "circuit_breaker": {
      "enabled": true,
      "failure_threshold": 5,
      "success_threshold": 2,
      "timeout": "60s",
      "half_open_requests": 3
    }
  },
  "routes": [
    {
      "path": "/pim/api/v1/product-hierarchy",
      "methods": ["GET"],
      "backends": [
        {
          "ziti_service": "dev.caches.rest.px",
          "identity_file": "./ziti-identity.json",
          "weight": 1,
          "priority": 1,
          "timeout": "30s",
          "max_retries": 3
        }
      ],
      "load_balancing": "round-robin",
      "strip_prefix": false,
      "rewrite_host": false,
      "timeout": "30s"
    },
    {
      "path": "/v1/caches/*",
      "methods": ["GET", "POST"],
      "backends": [
        {
          "ziti_service": "dev.caches.rest.px",
          "identity_file": "./ziti-identity.json",
          "weight": 2,
          "priority": 1,
          "timeout": "30s"
        },
        {
          "ziti_service": "dev.caches.rest.backup.px",
          "identity_file": "./ziti-identity-backup.json",
          "weight": 1,
          "priority": 2,
          "timeout": "30s"
        }
      ],
      "load_balancing": "weighted-round-robin",
      "health_check": {
        "enabled": true,
        "interval": "15s",
        "timeout": "5s",
        "path": "/health",
        "expected_status": 200,
        "failure_count": 2,
        "success_count": 1
      },
      "strip_prefix": false,
      "rewrite_host": false,
      "timeout": "30s"
    },
    {
      "path": "/health",
      "methods": ["GET"],
      "backends": [
        {
          "ziti_service": "dev.caches.rest.px",
          "identity_file": "./ziti-identity.json",
          "timeout": "5s"
        }
      ],
      "auth": {
        "type": "none"
      },
      "timeout": "5s"
    }
  ]
}
